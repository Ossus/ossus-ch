function setupCircus(){var e=$("#circus");for(p in _data){var t=_data[p],n="name"in t?t.name:p,r=$("<li/>"),i="url"in t?t.url:"",s=$("<a/>").attr("href",i),o=$("<img/>").attr("src","images/"+p+(onRetinaScreen()?"@2x":"")+".png").attr("alt",p),u=$("<span/>").text(n);s.append(o).append(u);r.append(s);s.click(function(e){e.stopPropagation();return!0});var a="desc"in t?t.desc:null;if(a){var f=$("<div/>").html("<h2>"+n+"</h2>"+a);f.click(function(e){e.stopPropagation();e.preventDefault()});r.append(f)}e.append(r);$(window).width()>=_w_desktop&&circlePutItemToPositionAtAngle(r,90)}}function toggleCircus(){var e=$(window).width(),t=$("#full"),n=$("#circus");n.parent().show();if(e<_w_desktop){t.hasClass("shown")?hideCircusOnPhones():showCircusOnPhones();return}var r=n.find("li"),i=360/r.length,s=-110,o=!t.hasClass("shown");if(!o){i=0;s=90}r.each(function(e,t){circleItemTo($(t),s+e*i,n)});t.toggleClass("shown");if(o){var u=300/$(window).width()*100;$("#full").css("background-size",u+"%")}else $("#full").css("background-size","40%")}function showCircusOnPhones(){$("#circus-wrap").show();window.setTimeout(function(){$("#full").addClass("shown")},10)}function hideCircusOnPhones(){$("#full").removeClass("shown");window.setTimeout(function(){$("#circus-wrap").hide()},1e3)}function onRetinaScreen(){return"devicePixelRatio"in window?window.devicePixelRatio>1.5:!1}function circleItemTo(e,t,n,r,i){var s=e.attr("id");if(!s){s="circle"+(new Date).getTime()+Math.round(Math.random()*1e5);e.attr("id",s)}var o=parseInt(e.css("left"))+e.outerWidth()/2,u=parseInt(e.css("top"))+e.outerHeight()/2,a=o-n.innerWidth()/2,f=u-n.innerHeight()/2,l=Math.atan2(f,a),c=Math.ceil(Math.sqrt(a*a+f*f));t%=360;t>180?t-=360:t<-180&&(t+=360);var h=deg2rad(t);while(h<l)h+=2*Math.PI;if(Math.round(l/.017453)==t)return!1;e.css("position","absolute");r=r?r:0;var p=(new Date).getTime(),d=i?i:_circleState.duration,v={view:e,width:e.width(),height:e.height(),box:{width:n.innerWidth(),height:n.innerHeight()},radius:c,start:{rad:l,time:p+r},end:{rad:h,time:p+r+d},duration:d,interval:null};_circleState.items[s]=v;_circleState.interval||(_circleState.interval=window.setInterval(_circleView,20));return!0}function _circleView(){var e=_circleState;if(!e)return;var t=(new Date).getTime(),n=0;for(var r in _circleState.items){var i=_circleState.items[r];if(i.start.time>t)continue;var s=0;n=Math.max(i.end.time,n);if(t<i.end.time){var o=(t-i.start.time)/i.duration,u=o;i.linear||(u=o*o*3-o*o*o*2);s=i.start.rad+u*(i.end.rad-i.start.rad)}else{s=i.end.rad;delete _circleState.items[r]}_circlePutItem(i.view,s,i.width,i.height,i.box)}if(n<t){window.clearInterval(_circleState.interval);_circleState.interval=null;_circleState.items={}}}function circlePutItemToPositionAtAngle(e,t){var n=e.offsetParent(),r={width:n.innerWidth(),height:n.innerHeight()};_circlePutItem(e,deg2rad(t),e.width(),e.height(),r)}function _circlePutItem(e,t,n,r,i){var s={x:i.width/2,y:i.height/2},o=Math.sin(t)*s.x,u=Math.cos(t)*s.x,a=s.x+u-n/2,f=s.y+o-r/2;i.width!=i.height;e.css("top",f).css("left",a)}function deg2rad(e){return e*.017453}var _w_tablet=460,_w_desktop=980,_circleState={items:[],interval:null,duration:1e3};